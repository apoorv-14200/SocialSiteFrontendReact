(this["webpackJsonpreact-social-site"]=this["webpackJsonpreact-social-site"]||[]).push([[0],{38:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),o=n(21),c=n.n(o),a=(n(38),n(3)),i=n(4),l=n(6),u=n(5),d=n(2),h=n(7),p=n(19),j="UPDATE_POSTS",f="LOGIN_START",m="LOGIN_SUCCESS",b="LOGIN_FAILED",O="SIGNUP_START",v="SIGNUP_SUCCESS",g="SIGNUP_FAILED",x="AUTHENTICATE_USER",S="LOG_OUT",N="CLEAR_AUTH_STATE",y="EDIT_PROFILE_SUCCESS",k="EDIT_PROFILE_FAILED",E="USER_PROFILE_SUCCESS",_="USER_PROFILE_FAILED",I="USER_PROFILE_BEGIN",C="CLEAR_PROFILE_STATE",F="FETCH_USER_FRIENDS_SUCCESS",R="FETCH_USER_FRIENDS_FAILED",P="FETCH_USER_FRIENDS_BEGIN",T="ADD_FRIEND_FAILED",L="ADD_FRIEND_SUCESS",w="ADD_FRIEND_BEGIN",U="REMOVE_FRIEND_FAILED",A="REMOVE_FRIEND_SUCESS",D="REMOVE_FRIEND_BEGIN",B="CLEAR_FRIEND_STATE",G="ADD_POST_SUCCESS",z="ADD_POST_FAILED",M="ADD_COMMENT_SUCCESS",V="ADD_COMMENT_FAILED",H="TOGGLE_LIKE_SUCCESS",J="TOGGLE_LIKE_FAILED",W="FETCH_SEARCH_USERS",q="CLEAR_SEARCH",K={posts:[],next:null,prev:null,error:null};var Q="https://powerful-hamlet-85569.herokuapp.com/api",X={fetchposts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return Q+"/posts?page=".concat(e,"&limit=").concat(t)},login:function(){return Q+"/users/login"},signup:function(){return Q+"/users/signup"},editProfile:function(){return Q+"/users/edit"},fetchProfile:function(e){return Q+"/users/".concat(e)},fetchFriends:function(){return Q+"/friendship/fetch_user_friends"},AddFriend:function(e){return Q+"/friendship/create_friendship?user_id=".concat(e)},RemoveFriend:function(e){return Q+"/friendship/remove_friendship?user_id=".concat(e)},createPost:function(){return Q+"/posts/create"},createComment:function(){return Q+"/comments"},toggleLike:function(e,t){return Q+"/likes/toggle?id=".concat(e,"&type=").concat(t)},SearchUsers:function(e){return Q+"/users/search?text=".concat(e)},UploadPic:function(){return Q+"/users/editPhoto/"},SERVER_URL:function(){return"https://powerful-hamlet-85569.herokuapp.com"}},Y=X,Z=Y.login();function $(e){return console.log(e),function(t){t({type:f}),fetch(Z,{method:"POST",body:JSON.stringify({email:e.email,password:e.password}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){console.log(e),e.success?(localStorage.setItem("token",e.data.token),setTimeout((function(){var n;t((n=e.data.user,{type:m,user:n}))}),1e3)):setTimeout((function(){var n;t((n=e.error,{type:b,error:n}))}),1e3)})).catch((function(e){return console.log("error",e)}))}}function ee(){return{type:S}}function te(){return{type:N}}function ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Y.fetchposts(e);return function(e){fetch(t).then((function(e){return e.json()})).then((function(t){var n=t.next,r=t.prev;"undefined"==typeof n&&(n=null),"undefined"==typeof r&&(r=null),e(re(t.data.posts,n,r))})).catch((function(e){return console.log("error",e)}))}}function re(e,t,n){return{type:j,posts:e,next:t,prev:n}}function se(e){var t=Y.createPost();return function(n){var r=localStorage.getItem("token");fetch(t,{method:"POST",body:JSON.stringify({content:e}),headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&n(ee()),e.json()})).then((function(e){e.success?setTimeout((function(){var t;n((t=e.data.post,{type:G,post:t}))}),500):setTimeout((function(){var t;n((t=e.error,{type:z,error:t}))}),500)})).catch((function(e){return console.log("error",e)}))}}var oe=n(8),ce=n(12);function ae(e,t){var n=Y.createComment();return function(r){var s=localStorage.getItem("token");fetch(n,{method:"POST",body:JSON.stringify({content:e,post_id:t}),headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(s)}}).then((function(e){return"401"==e.status&&r(ee()),e.json()})).then((function(e){console.log(e),e.success?setTimeout((function(){r(function(e,t){return{type:M,comment:e,post_id:t}}(e.comment,t))}),500):setTimeout((function(){var t;r((t=e.error,{type:V,error:t}))}),500)})).catch((function(e){return console.log("error",e)}))}}function ie(e,t){var n=Y.toggleLike(e,t);return function(r){var s=localStorage.getItem("token");fetch(n,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(s)}}).then((function(e){return e.json()})).then((function(n){console.log(n),n.success?setTimeout((function(){r(function(e,t,n,r){return{type:H,deleted:e,id:t,likeabletype:n,like:r}}(n.data.deleted,e,t,n.data.liketosent))}),50):setTimeout((function(){var e;r((e=n.error,{type:J,error:e}))}),50)})).catch((function(e){return console.log("error",e)}))}}var le=n(0),ue=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).handleToggleLike=function(){var t=e.props.comment;e.props.dispatch(ie(t._id,"Comment"))},e.isLikedByUser=function(){var t,n=e.props.comment,r=e.props.auth.user;for(t=0;t<n.likes.length;t++)if(n.likes[t].user==r._id)return!0;return!1},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.isLikedByUser();console.log(e);var t=this.props.comment;return Object(le.jsxs)("div",{className:"comment",children:[Object(le.jsxs)("div",{className:"name-time",children:[t.user.name," a minute ago"]}),Object(le.jsx)("div",{className:"comment-content",children:t.content}),Object(le.jsxs)("div",{className:"comment-likes-count",children:[Object(le.jsx)("img",{onClick:this.handleToggleLike,src:e?"https://cdn-icons-png.flaticon.com/512/633/633991.png":"https://cdn-icons-png.flaticon.com/512/633/633759.png"}),t.likes.length]})]})}}]),n}(r.Component);var de=Object(h.b)((function(e){return{auth:e.auth,posts:e.posts}}))(ue),he=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this)).handleChange=function(e){var t=e.target.value;r.setState({content:t})},r.handleAddcomment=function(e){var t=r.props.post;""!==r.state.content&&"Enter"==e.key&&(r.props.dispatch(ae(r.state.content,t._id)),r.setState({content:""}))},r.handleToggleLike=function(){var e=r.props.post;r.props.dispatch(ie(e._id,"Post"))},r.isLikedByUser=function(){var e,t=r.props.post,n=r.props.auth.user;for(e=0;e<t.likes.length;e++)if(t.likes[e].user==n._id)return!0;return!1},r.state={content:""},r}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.post,t=this.isLikedByUser(),n=Y.SERVER_URL()+e.user.avatar;return console.log("LIKED",t),Object(le.jsxs)("div",{className:"Post",children:[Object(le.jsxs)("div",{className:"user-info",children:[Object(le.jsx)(ce.b,{to:"/SocialSiteFrontendReact/user/".concat(e.user._id),children:Object(le.jsx)("img",{src:e.user.avatar?n:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png",className:"post-icon"})}),Object(le.jsxs)("div",{className:"post-user-name",children:[e.user.name,Object(le.jsx)("div",{className:"time",children:"a minute ago"})]})]}),Object(le.jsx)("p",{className:"post-content",children:e.content}),Object(le.jsxs)("div",{className:"likes-comment-icon",children:[Object(le.jsx)("img",{onClick:this.handleToggleLike,src:t?"https://cdn-icons-png.flaticon.com/512/1076/1076984.png":"https://cdn-icons-png.flaticon.com/512/1077/1077035.png"}),Object(le.jsx)("div",{className:"likes-count",children:e.likes.length}),Object(le.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/1380/1380338.png"}),Object(le.jsx)("div",{className:"comments-count",children:e.comment.length})]}),Object(le.jsxs)("div",{className:"comments",children:[Object(le.jsx)("input",{onChange:this.handleChange,onKeyPress:this.handleAddcomment,onk:!0,className:"comments-form",placeholder:"Type your comment here"}),e.comment.map((function(e){return Object(le.jsx)(de,{comment:e},e._id)}))]})]})}}]),n}(r.Component);var pe=Object(h.b)((function(e){return{auth:e.auth,posts:e.posts}}))(he),je=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleChange=function(e){r.setState({post_content:e.target.value})},r.handleSubmit=function(){var e=r.state.post_content;0!=e.length&&r.props.dispatch(se(e))},r.state={post_content:""},r}return Object(i.a)(n,[{key:"render",value:function(){var e=this,t=this.props.posts.error;return Object(le.jsxs)("div",{className:"post-form-container",children:[0==t&&Object(le.jsx)("div",{className:"success-dialog",children:"Post Created Successfully"}),t&&Object(le.jsx)("div",{className:"alert-dialog",children:t}),Object(le.jsx)("div",{className:"post-input-container",children:Object(le.jsx)("textarea",{onChange:function(t){return e.handleChange(t)},placeholder:"What's in your mind?"})}),Object(le.jsx)("div",{className:"post-btn-container",children:Object(le.jsx)("div",{onClick:this.handleSubmit,className:"post-btn",children:"Add Post"})})]})}}]),n}(r.Component);var fe=Object(h.b)((function(e){return{posts:e.posts}}))(je),me=n(17),be=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.dispatch(ne())}},{key:"render",value:function(){var e=this.props.posts,t=e.posts,n=(e.error,this.props.auth.isLoggedIn);return 0==t.length?Object(le.jsx)(me.BookLoader,{text:"Fetching Posts...",background:"linear-gradient(135deg, #6066FA, #4645F6)",desktopSize:"50px",mobileSize:"50px",textColor:"#4645F6"}):Object(le.jsxs)("div",{className:"post-list1",children:[n&&Object(le.jsx)(fe,{}),Object(le.jsx)("div",{className:n?"Post-list":"Post-listN",children:t.map((function(e){return Object(le.jsx)(pe,{post:e},e._id)}))})]})}}]),n}(r.Component);var Oe=Object(h.b)((function(e){return{auth:e.auth,posts:e.posts}}))(be),ve=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.result;console.log("RESULT",e);var t=Y.SERVER_URL()+e.avatar;return Object(le.jsx)(ce.b,{to:"/SocialSiteFrontendReact/user/".concat(e._id),children:Object(le.jsxs)("div",{className:"result",children:[Object(le.jsx)("img",{src:e.avatar?t:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"}),Object(le.jsx)("div",{children:e.name})]})})}}]),n}(r.Component),ge=ve;function xe(e){var t=Y.SearchUsers(e);return function(e){var n=localStorage.getItem("token");fetch(t,{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(n)}}).then((function(t){return"401"==t.status&&e(ee()),t.json()})).then((function(t){var n;e((n=t.data.users,{type:W,results:n}))})).catch((function(e){return console.log("error",e)}))}}var Se=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleChange=function(e){var t=e.target.value;""!==t?r.props.dispatch(xe(t)):r.props.dispatch({type:q})},r.handleInputFocus=function(){r.setState({focus:!0})},r.handleInputBlur=function(e){var t=document.getElementsByClassName("search");if(0!=t.length){var n=t[0].contains(e.target);console.log(n),n||r.setState({focus:!1})}},r.state={focus:!1},r}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("click",(function(t){e.handleInputBlur(t)}))}},{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("click",(function(t){e.handleInputBlur(t)}))}},{key:"render",value:function(){var e=this,t=this.props.search.results;console.log("RESULTS",t);var n=this.state.focus;return Object(le.jsxs)("div",{className:"search",onFocus:this.handleInputFocus,children:[Object(le.jsx)("input",{onChange:this.handleChange,placeholder:"Search name"}),0!=t.length&&0!=n&&Object(le.jsx)("div",{className:"search-results",children:t.map((function(t){return Object(le.jsx)(ge,{onFocus:e.handleInputFocus,result:t},t._id)}))})]})}}]),n}(r.Component);var Ne=Object(h.b)((function(e){return{auth:e.auth,search:e.search}}))(Se),ye=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).logOut=function(){localStorage.removeItem("token"),e.props.dispatch(ee())},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.auth,t=e.isLoggedIn,n=e.user,r=window.location.href;console.log(r);var s=Y.SERVER_URL()+n.avatar;return Object(le.jsxs)("div",{className:"navbar",children:[Object(le.jsxs)("div",{className:"nav-left-container",children:[Object(le.jsx)(ce.b,{to:"/SocialSiteFrontendReact/",children:Object(le.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/2111/2111421.png",className:"logo"})}),Object(le.jsx)("div",{className:"site-name",children:"Socializer"})]}),Object(le.jsx)("div",{className:"nav-middle-container",children:Object(le.jsx)(Ne,{})}),Object(le.jsxs)("div",{className:"nav-right-container",children:[t&&Object(le.jsxs)("div",{className:"user-nav",children:[Object(le.jsx)(ce.b,{to:"/SocialSiteFrontendReact/settings",children:Object(le.jsx)("img",{src:n.avatar?s:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png",className:"user-logo"})}),Object(le.jsx)("div",{className:"username-nav",children:n.name})]}),0==t&&Object(le.jsx)(ce.b,{className:"nav-btn",to:"/SocialSiteFrontendReact/login",children:Object(le.jsx)("div",{children:"LogIn"})}),t&&Object(le.jsx)("button",{onClick:this.logOut,className:"logout-btn",children:"LogOut"}),0==t&&Object(le.jsx)(ce.b,{className:"nav-btn",to:"/SocialSiteFrontendReact/Register",children:Object(le.jsx)("div",{children:"Register"})})]})]})}}]),n}(r.Component);var ke=Object(h.b)((function(e){return{auth:e.auth}}))(ye),Ee=n(15);function _e(){return function(e){var t=Y.fetchFriends(),n=localStorage.getItem("token");e({type:P}),fetch(t,{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(n)}}).then((function(t){return"401"==t.status&&e(ee()),t.json()})).then((function(t){console.log("Data",t),t.success?setTimeout((function(){var n;e((n=t.data.friendships,{type:F,friendships:n}))}),500):setTimeout((function(){var n;e((n=t.error,{type:R,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}function Ie(e){return function(t){var n=Y.AddFriend(e),r=localStorage.getItem("token");t({type:w}),fetch(n,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&t(ee()),e.json()})).then((function(e){console.log("Data",e),e.success?setTimeout((function(){var n;t((n=e.data.friendship,{type:L,friendship:n}))}),500):setTimeout((function(){var n;t((n=e.error,{type:T,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}function Ce(){return{type:B}}function Fe(e){return function(t){var n=Y.RemoveFriend(e),r=localStorage.getItem("token");t({type:D}),fetch(n,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&t(ee()),e.json()})).then((function(e){console.log("Data",e),e.success?setTimeout((function(){t(function(e){return{type:A,id:e}}(e.removed_id))}),500):setTimeout((function(){var n;t((n=e.error,{type:U,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}var Re=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.friend,t=Y.SERVER_URL()+e.avatar;return Object(le.jsxs)("div",{className:"friend",children:[Object(le.jsx)("div",{className:"friend-icon",children:Object(le.jsx)(ce.b,{to:"/SocialSiteFrontendReact/user/".concat(e._id),children:Object(le.jsx)("img",{src:e.avatar?t:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"})})}),Object(le.jsx)("div",{className:"friend-name",children:Object(le.jsx)("div",{children:e.name})})]})}}]),n}(r.Component),Pe=Re,Te=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(Ce())}},{key:"componentDidMount",value:function(){this.props.dispatch(_e())}},{key:"render",value:function(){var e,t=this.props.friends,n=t.friendships,r=t.inProgress,s=t.error,o=this.props.auth.user;return r?Object(le.jsx)(me.WifiLoader,(e={className:"loader",background:"transparent",backColor:"rgb(66, 110, 240)",desktopSize:"90px",mobileSize:"90px",text:"Fetching Friends..."},Object(Ee.a)(e,"backColor","rgb(66, 110, 240)"),Object(Ee.a)(e,"frontColor","#4645F6"),e)):s?Object(le.jsx)("h1",{children:s}):Object(le.jsxs)("div",{className:"friends-container",children:[Object(le.jsx)("div",{className:"friends-heading",children:"Friends"}),n.map((function(e){var t=e.from_user;return t._id==o._id&&(t=e.to_user),Object(le.jsx)(Pe,{friend:t})}))]})}}]),n}(r.Component);var Le=Object(h.b)((function(e){return{auth:e.auth,friends:e.friends}}))(Te),we=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).handlenextclick=function(){var t=e.props.posts.next;e.props.dispatch(ne(t.page))},e.handleprevclick=function(){var t=e.props.posts.prev;e.props.dispatch(ne(t.page))},e}return Object(i.a)(n,[{key:"render",value:function(){this.props.posts.posts;var e=this.props.posts,t=e.next,n=e.prev;return Object(le.jsxs)("div",{className:"Footer-container",children:[Object(le.jsxs)("div",{className:"footer-btns",children:[Object(le.jsx)("button",{onClick:this.handleprevclick,className:n?"fbtn":"fbtn hidebtn",children:"<"}),Object(le.jsx)("button",{onClick:this.handlenextclick,className:t?"fbtn":"fbtn hidebtn",children:">"})]}),Object(le.jsx)("div",{className:"footer",children:"\xa9 2021 Apoorv Jain"})]})}}]),n}(r.Component);var Ue=Object(h.b)((function(e){return{posts:e.posts}}))(we),Ae=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.auth.isLoggedIn;return console.log("props",this.props),Object(le.jsxs)("div",{className:"home",children:[Object(le.jsx)(Oe,{}),e&&Object(le.jsx)(Le,{})]})}}]),n}(r.Component);var De=Object(h.b)((function(e){return{auth:e.auth}}))(Ae);var Be=function(e){return Object(le.jsx)("div",{children:Object(le.jsx)("h1",{children:"404: Page not found"})})},Ge=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleEmailInput=function(e){var t=e.target.value;r.setState({email:t})},r.handlePasswordInput=function(e){var t=e.target.value;r.setState({password:t})},r.handleSubmit=function(e){e.preventDefault(),console.log(r.state),r.props.dispatch($(r.state))},r.state={email:"",password:""},r}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(te())}},{key:"render",value:function(){var e=this.props.auth,t=e.error,n=e.inProgress,r=e.user,s=e.isLoggedIn,o=(this.props.location.state||{from:{pathname:"/SocialSiteFrontendReact/"}}).from;return s?Object(le.jsx)(oe.a,{to:o}):(console.log(this.props.auth),Object(le.jsxs)("div",{className:"login-container",children:[Object(le.jsx)("div",{className:"login-heading",children:"Login"}),t&&Object(le.jsx)("div",{className:"alert-dialog",children:t}),s&&Object(le.jsx)("div",{className:"success-dialog",children:"Successfully signed in as ".concat(r.name)}),Object(le.jsxs)("form",{className:"login-form",children:[Object(le.jsx)("input",{type:"email",required:!0,placeholder:"Enter your email",onChange:this.handleEmailInput}),Object(le.jsx)("input",{type:"password",required:!0,placeholder:"Enter your password",onChange:this.handlePasswordInput}),n?Object(le.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,disabled:n,children:"Logging In"}):Object(le.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,children:"Log In"})]})]}))}}]),n}(r.Component);var ze=Object(h.b)((function(e){return{auth:e.auth}}))(Ge),Me=Y.signup();function Ve(e){return console.log(e),function(t){t({type:O}),fetch(Me,{method:"POST",body:JSON.stringify({email:e.email,password:e.password,confirmpassword:e.confirmpassword,name:e.name}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){console.log(e),e.success?setTimeout((function(){var n;localStorage.setItem("token",e.data.token),t((n=e.data.user,{type:v,user:n}))}),1e3):setTimeout((function(){var n;t((n=e.error,{type:g,error:n}))}),1e3)})).catch((function(e){return console.log("error",e)}))}}var He=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleEmailInput=function(e){var t=e.target.value;r.setState({email:t})},r.handleConfirmPasswordInput=function(e){var t=e.target.value;r.setState({confirmpassword:t})},r.handleNameInput=function(e){var t=e.target.value;r.setState({name:t})},r.handlePasswordInput=function(e){var t=e.target.value;r.setState({password:t})},r.handleSubmit=function(e){e.preventDefault(),console.log(r.state),r.props.dispatch(Ve(r.state))},r.state={email:"",password:"",confirmpassword:"",name:""},r}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(te())}},{key:"render",value:function(){var e=this.props.auth,t=e.error,n=e.inProgress,r=e.user,s=e.isLoggedIn;return s?Object(le.jsx)(oe.a,{to:"/SocialSiteFrontendReact"}):(console.log(this.props.auth),Object(le.jsxs)("div",{className:"login-container",children:[Object(le.jsx)("div",{className:"login-heading",children:"SignUp"}),t&&Object(le.jsx)("div",{className:"alert-dialog",children:t}),s&&Object(le.jsx)("div",{className:"success-dialog",children:"Successfully signed in as ".concat(r.user.name)}),Object(le.jsxs)("form",{className:"login-form",children:[Object(le.jsx)("input",{type:"text",required:!0,placeholder:"Enter your name",onChange:this.handleNameInput}),Object(le.jsx)("input",{type:"email",required:!0,placeholder:"Enter your email",onChange:this.handleEmailInput}),Object(le.jsx)("input",{type:"password",required:!0,placeholder:"Enter your password",onChange:this.handlePasswordInput}),Object(le.jsx)("input",{type:"password",required:!0,placeholder:"Enter password again",onChange:this.handleConfirmPasswordInput}),n?Object(le.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,disabled:n,children:"Signing Up"}):Object(le.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,children:"Sign Up"})]})]}))}}]),n}(r.Component);var Je=Object(h.b)((function(e){return{auth:e.auth}}))(He),We=n(31);Y.UploadPic();function qe(e){return{type:y,user:e}}function Ke(e){return{type:k,error:e}}var Qe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleUpload=function(){var e=r.props.auth.user;r.state.selectedFile&&r.props.dispatch(function(e,t){var n=Y.UploadPic();return console.log(n),console.log(t),console.log(e),function(e){var r=localStorage.getItem("token"),s=new FormData;s.append("avatar",t),fetch(n,{method:"POST",body:s,headers:{Authorization:"Bearer ".concat(r)}}).then((function(t){return"401"==t.status&&e(ee()),t.json()})).then((function(t){console.log(t),t.success?(localStorage.setItem("token",t.data.token),setTimeout((function(){e(qe(t.data.user))}),500)):setTimeout((function(){e(Ke(t.error))}),500)})).catch((function(e){return console.log("error",e)}))}}(e._id,r.state.selectedFile))},r.handleFile=function(e){console.log(e.target.files[0]),r.setState({selectedFile:e.target.files[0]})},r.handleChange=function(e,t){r.setState(Object(Ee.a)({},t,e))},r.handleEdit=function(){r.setState({editmode:!0})},r.handleBack=function(){r.setState({editmode:!1})},r.fun=function(){0==r.props.auth.error&&r.setState({editmode:!1})},r.handleSave=function(){var e=r.state,t=e.name,n=e.password,s=e.confirmpassword;if(0==t.length||0==n.length||s!=n)r.props.dispatch(Ke("Invalid Input"));else{var o=r.props.auth.user._id;console.log("Success",o),r.props.dispatch(function(e,t,n,r){console.log(r);var s=Y.editProfile();return function(o){var c=localStorage.getItem("token");fetch(s,{method:"POST",body:JSON.stringify({name:e,password:t,confirmpassword:n,id:""+r}),headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(c)}}).then((function(e){return"401"==e.status&&o(ee()),e.json()})).then((function(e){console.log(e),e.success?(localStorage.setItem("token",e.data.token),setTimeout((function(){o(qe(e.data.user))}),500)):setTimeout((function(){o(Ke(e.error))}),500)})).catch((function(e){return console.log("error",e)}))}}(t,n,s,o)),setTimeout(r.fun,1e3)}},r.state={editmode:!1,name:e.auth.user.name,password:"",confirmpassword:"",selectedFile:null},r}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(te())}},{key:"render",value:function(){var e=this,t=this.state.editmode,n=this.props.auth,r=n.user,s=n.error,o=(n.profile_changed,Y.SERVER_URL()+r.avatar);return console.log("IMAGE",o),console.log(t),Object(le.jsxs)("div",{className:"profile-container",children:[Object(le.jsx)("div",{className:"user-icon",children:Object(le.jsx)("img",{src:void 0!==r.avatar?o:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"})}),Object(le.jsxs)("div",{className:"setting-container",children:[s&&Object(le.jsx)("div",{className:"alert-dialog",children:s}),0==s&&1==t&&Object(le.jsx)("div",{className:"success-dialog",children:"Successfully Updated"}),Object(le.jsxs)("div",{className:"show-field2",children:[Object(le.jsx)("input",{className:"show-field-input2",type:"file",onChange:this.handleFile}),Object(le.jsx)("button",{className:"upload-btn",onClick:this.handleUpload,children:"Upload"})]}),Object(le.jsxs)("div",{className:"show-field",children:[Object(le.jsx)("div",{className:"show-field-heading",children:"Email"}),Object(le.jsx)("div",{className:"show-field-input",children:r.email})]}),0==t&&Object(le.jsxs)("div",{className:"show-field",children:[Object(le.jsx)("div",{className:"show-field-heading",children:"Name"}),Object(le.jsx)("div",{className:"show-field-input",children:r.name})]}),t&&Object(le.jsxs)("div",{className:"show-input",children:[Object(le.jsx)("div",{className:"show-field-heading",children:"Name"}),Object(le.jsx)("input",{value:this.state.name,onChange:function(t){e.handleChange(t.target.value,"name")}})]}),t&&Object(le.jsxs)("div",{className:"show-input",children:[Object(le.jsx)("div",{className:"show-field-heading",children:"New Password"}),Object(le.jsx)("input",{onChange:function(t){e.handleChange(t.target.value,"password")}})]}),t&&Object(le.jsxs)("div",{className:"show-input",children:[Object(le.jsx)("div",{className:"show-field-heading",children:"Confirm Password"}),Object(le.jsx)("input",{onChange:function(t){e.handleChange(t.target.value,"confirmpassword")}})]}),Object(le.jsxs)("div",{className:"Button-container",children:[0==t&&Object(le.jsx)("button",{className:"setting-btn",onClick:this.handleEdit,children:"Edit Profile"}),t&&Object(le.jsx)("button",{className:"setting-btn",onClick:this.handleSave,children:"Save Profile"}),t&&Object(le.jsx)("button",{className:"setting-btn",onClick:this.handleBack,children:"Go Back"})]})]})]})}}]),n}(r.Component);var Xe=Object(h.b)((function(e){return{auth:e.auth}}))(Qe);function Ye(e){return function(t){var n=Y.fetchProfile(e);t({type:I});var r=localStorage.getItem("token");fetch(n,{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&t(ee()),e.json()})).then((function(e){console.log(e),e.success?setTimeout((function(){var n;t((n=e.data.user,{type:E,user:n}))}),500):setTimeout((function(){var n;t((n=e.error,{type:_,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}var Ze=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleAddfriend=function(){var e=r.props.match.params.userId;r.props.dispatch(Ie(e))},r.handleRemoveFriend=function(){var e=r.props.match.params.userId;r.props.dispatch(Fe(e))},r.checkIsUserFriend=function(){var e=r.props.match.params.userId,t=r.props.auth.user,n=r.props.friends.friendships,s=[];return n.map((function(e){var n=e.from_user._id;n==t._id&&(n=e.to_user._id),s.push(n)})),-1!==s.indexOf(e)},r}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.match.params.userId&&this.props.dispatch(Ye(this.props.match.params.userId))}},{key:"componentDidUpdate",value:function(e){var t=e.match.params,n=this.props.match.params;n&&t&&n.userId!==t.userId&&this.props.dispatch(Ye(n.userId))}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Ce())}},{key:"render",value:function(){var e=this.checkIsUserFriend(),t=this.props.profile.user,n=this.props.auth.user,r=this.props.profile,s=r.error,o=r.inProgress,c=Y.SERVER_URL()+t.avatar;return console.log("PROFILE",t),n.email==t.email?Object(le.jsx)(oe.a,{to:"/SocialSiteFrontendReact/settings"}):o?Object(le.jsx)("div",{className:"ploader",children:Object(le.jsx)(me.BoxesLoader,{boxColor:"#6366F1",style:{marginBottom:"20px"},desktopSize:"128px",mobileSize:"80px"})}):s?Object(le.jsx)("h1",{children:s}):Object(le.jsxs)("div",{className:"profile-container",children:[Object(le.jsx)("div",{className:"user-icon",children:Object(le.jsx)("img",{src:void 0!==t.avatar?c:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"})}),Object(le.jsxs)("div",{className:"setting-container",children:[this.props.friends.error&&Object(le.jsx)("div",{className:"alert-dialog",children:this.props.friends.error}),0==this.props.friends.error&&Object(le.jsxs)("div",{className:"success-dialog",children:["Successfully ",e?"added":"removed"," friend"]}),Object(le.jsxs)("div",{className:"show-field",children:[Object(le.jsx)("div",{className:"show-field-heading",children:"Email"}),Object(le.jsx)("div",{className:"show-field-input",children:t.email})]}),Object(le.jsxs)("div",{className:"show-field",children:[Object(le.jsx)("div",{className:"show-field-heading",children:"Name"}),Object(le.jsx)("div",{className:"show-field-input",children:t.name})]}),Object(le.jsx)("div",{className:"Button-container",children:0==e?Object(le.jsx)("button",{className:"add-friend-btn",disabled:this.props.friends.inProgress,onClick:this.handleAddfriend,children:this.props.friends.inProgress?"Adding Friend":"Add Friend"}):Object(le.jsx)("button",{className:"add-friend-btn",disabled:this.props.friends.inProgress,onClick:this.handleRemoveFriend,children:this.props.friends.inProgress?"Removing Friend":"Remove Friend"})})]})]})}}]),n}(r.Component);var $e=Object(h.b)((function(e){return{auth:e.auth,profile:e.profile,friends:e.friends}}))(Ze),et=function(e){var t=e.isLoggedIn,n=e.path,r=e.component;return Object(le.jsx)(oe.b,{path:n,render:function(e){return console.log("Props",e),1==t?Object(le.jsx)(r,Object(d.a)({},e)):Object(le.jsx)(oe.a,{to:{pathname:"/SocialSiteFrontendReact/login",state:{from:e.location}}})}})},tt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("token");if(e){var t=Object(We.a)(e);this.props.dispatch(function(e){return{type:x,user:e}}(t))}}},{key:"render",value:function(){var e=this.props,t=(e.posts,e.auth);return console.log("loggedin",t.isLoggedIn),Object(le.jsx)(ce.a,{children:Object(le.jsxs)("div",{children:[Object(le.jsx)(ke,{}),Object(le.jsxs)(oe.d,{children:[Object(le.jsx)(oe.b,{exact:!0,path:"/SocialSiteFrontendReact",render:function(e){return Object(le.jsx)(De,Object(d.a)({},e))}}),Object(le.jsx)(oe.b,{path:"/SocialSiteFrontendReact/login",exact:!0,component:ze}),Object(le.jsx)(oe.b,{path:"/SocialSiteFrontendReact/Register",exact:!0,component:Je}),Object(le.jsx)(et,{path:"/SocialSiteFrontendReact/settings",exact:!0,component:Xe,isLoggedIn:t.isLoggedIn}),Object(le.jsx)(et,{path:"/SocialSiteFrontendReact/user/:userId",exact:!0,component:$e,isLoggedIn:t.isLoggedIn}),Object(le.jsx)(oe.b,{component:Be})]}),Object(le.jsx)(Ue,{})]})})}}]),n}(r.Component);var nt=Object(h.b)((function(e){return{posts:e.posts,auth:e.auth}}))(tt),rt=n(20),st=n(32),ot={user:{},error:null,isLoggedIn:!1,inProgress:!1,profile:""};var ct={inProgress:!1,user:{},error:null};var at={friendships:[],inProgress:!1,error:null};var it={results:[]};var lt=Object(rt.b)({posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(d.a)(Object(d.a)({},e),{},{posts:t.posts,next:t.next,prev:t.prev,error:null});case G:return{posts:[t.post].concat(Object(p.a)(e.posts)),error:!1};case z:return Object(d.a)(Object(d.a)({},e),{},{error:t.error});case M:var n=e.posts.map((function(e){return e._id==t.post_id?Object(d.a)(Object(d.a)({},e),{},{comment:[t.comment].concat(Object(p.a)(e.comment))}):e}));return Object(d.a)(Object(d.a)({},e),{},{posts:n,error:null});case V:return{error:t.error};case H:if("Post"==t.likeabletype){var r=e.posts.map((function(e){if(e._id==t.id){if(t.deleted){var n=e.likes.filter((function(e){return e._id!=t.like._id}));return Object(d.a)(Object(d.a)({},e),{},{likes:n})}var r=e.likes;return r.push(t.like),Object(d.a)(Object(d.a)({},e),{},{likes:r})}return e}));return Object(d.a)(Object(d.a)({},e),{},{posts:r})}var s=e.posts.map((function(e){var n=e.comment.map((function(e){if(e._id==t.id){if(t.deleted){var n=e.likes.filter((function(e){return e._id!=t.like._id}));return Object(d.a)(Object(d.a)({},e),{},{likes:n})}var r=e.likes;return r.push(t.like),Object(d.a)(Object(d.a)({},e),{},{likes:r})}return e}));return Object(d.a)(Object(d.a)({},e),{},{comment:n})}));return Object(d.a)(Object(d.a)({},e),{},{posts:s});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,t=arguments.length>1?arguments[1]:void 0;switch(console.log("action-----\x3e",t),t.type){case f:case O:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!0});case m:case v:return Object(d.a)(Object(d.a)({},e),{},{isLoggedIn:!0,inProgress:!1,error:null,user:t.user});case b:case g:case k:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:t.error});case x:return Object(d.a)(Object(d.a)({},e),{},{error:null,user:t.user,isLoggedIn:!0});case S:return{user:{},error:null,isLoggedIn:!1,inProgress:!1};case N:return Object(d.a)(Object(d.a)({},e),{},{error:null,editmode:!1});case y:return Object(d.a)(Object(d.a)({},e),{},{isLoggedIn:!0,inProgress:!1,error:!1,user:t.user,editmode:!1});default:return e}},profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!0,error:null});case E:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,user:t.user,error:null});case _:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:t.error});case C:return{inProgress:!1,user:{},error:null};default:return e}},friends:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object(d.a)(Object(d.a)({},e),{},{error:t.error,inProgress:!1});case P:return Object(d.a)(Object(d.a)({},e),{},{error:null,inProgress:!0});case F:return Object(d.a)(Object(d.a)({},e),{},{error:null,inProgress:!1,friendships:t.friendships});case L:return Object(d.a)(Object(d.a)({},e),{},{error:!1,inProgress:!1,friendships:[].concat(Object(p.a)(e.friendships),[t.friendship])});case w:case D:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!0,error:null});case T:case U:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:t.error});case B:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:null});case A:return Object(d.a)(Object(d.a)({},e),{},{error:!1,inProgress:!1,friendships:e.friendships.filter((function(e){return e._id!==t.id}))});default:return e}},search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return Object(d.a)(Object(d.a)({},e),{},{results:t.results});case q:return{results:[]};default:return e}}}),ut=n(33),dt=n.n(ut);var ht=Object(rt.c)(lt,Object(rt.a)(dt.a,st.a));console.log(ht.getState()),c.a.render(Object(le.jsx)(h.a,{store:ht,children:Object(le.jsx)(s.a.StrictMode,{children:Object(le.jsx)(nt,{})})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.5d31c065.chunk.js.map